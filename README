UrbiOpenNIKinect
--------------------------------------------------------------------------------
INFO
--------------------------------------------------------------------------------

Kinect module based on OpenNI for URBI
Copyright (C) 2012  Lukasz Malek
 
This program is free software: you can redistribute it and/or modify
it under the terms of the GNU General Public License as published by
the Free Software Foundation, either version 3 of the License, or
(at your option) any later version.
 
This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU General Public License for more details.
  
You should have received a copy of the GNU General Public License
along with this program.  If not, see <http://www.gnu.org/licenses/>.

--------------------------------------------------------------------------------
REQUIREMENTS
--------------------------------------------------------------------------------

1. Download unstable OpenNI and NITE from 
   http://www.openni.org/Downloads/OpenNIModules.aspx 
   tested on:
	- OpenNI-Bin-Dev-Linux-x64-v1.5.2.23
	- NITE-Bin-Dev-Linux-x64-v1.5.2.21
2. Install OpenNI and NITE
3. Download SensorKinect from avin2 github
   https://github.com/avin2/SensorKinect
   The easiest way is to download ZIP archive.
4. Extract SensorKinect archive. Go to extracted direcotry.
   Build sensor according to the information from README.
   Go to Bin dir end extrac SensorKinect... suitable for your system.
5. Install SensorKinect
6. Adjust NITE to work with Kinect
   cp NITE_Data/*.xml [NITE_DIR]/Data/
7. Reboot
8. Make sure that your user has permission to use kinect device
9. Plug Kinect and test it with 
   [OpenNI-DIR]/Samples/Bin/[...]/NIViewer 
   

ALTERNATIVE

Instead of manually building OpenNI on Ubintu one can instal it from pepository
https://launchpad.net/~admo/+archive/openni by typing

sudo apt-add-apt-repository ppa:admo/openni



--------------------------------------------------------------------------------
INSTALATION
--------------------------------------------------------------------------------

This library is prepared to work with the cmake.
Create new directory

mkdir build

then run cmake, ccmake or cmake-gui to configure project

ccmake ../

after configuring project type

make



--------------------------------------------------------------------------------
NOTES
--------------------------------------------------------------------------------

Example of usage:

urbi -i -m UKinectOpenNI -P 54000

var Global.xyz;
var Global.Kinect=UKinectOpenNI.new(true,true,true);
Kinect.refreshData();
Kinect.getUsers();
Kinect.getImage();
t:loop{
    Kinect.refreshData();
    Kinect.getUsers();
    if (Kinect.numUsers > 0) {
        echo(Kinect.numUsers);
        xyz = Kinect.getJointPosition(1,3);
        echo("x="+xyz[0]+" y="+xyz[1]+" z="+xyz[2]);
    };
    sleep(0.03s);
},

var Global.Kinect=UKinectOpenNI.new(true,true,true);
t:loop{
    Kinect.refreshData();
    Kinect.getImage();
    Kinect.getDepth();
    Kinect.getUsers();
    Kinect.getSkeleton(Kinect.image);
    sleep(0.03s);
},

t:loop{
    Kinect.refreshData();
    Kinect.getImage();
    Kinect.getDepth();
    Kinect.getUsers();
    Kinect.getSkeleton(Kinect.depth);
    sleep(0.03s);
},

t:loop{
    Kinect.refreshData();
    Kinect.getImage();
    Kinect.getDepth();
    Kinect.getUsers();
    Kinect.getSkeleton(Kinect.depth);
    sleep(0.03s);
},


var Global.Kinect=UKinectOpenNI.new(true,true,true);
Kinect.matchDepthToImage(true);

t:loop{
    Kinect.refreshData();
    Kinect.getImage();
    Kinect.getDepth();
    Kinect.getUsers();
    Kinect.getSkeleton(Kinect.image);
    sleep(0.03s);
},